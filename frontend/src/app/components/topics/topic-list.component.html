<!--frontend/src/app/components/topics/topic-list.component.html-->
<app-navbar></app-navbar>

<!-- Topics Page Navigation Menu -->
<nav class="dashboard-nav">
  <div class="nav-container">
    <div class="nav-menu">
      <a class="nav-item" routerLink="/dashboard" routerLinkActive="active">
        <i class="fas fa-home"></i>
        <span>Dashboard</span>
      </a>
      <a class="nav-item" routerLink="/voice-interview" routerLinkActive="active">
        <i class="fas fa-microphone"></i>
        <span>Voice Interview</span>
      </a>
      <a class="nav-item" routerLink="/whiteboard" routerLinkActive="active">
        <i class="fas fa-palette"></i>
        <span>Whiteboard</span>
      </a>
      <a class="nav-item" routerLink="/flashcards" routerLinkActive="active">
        <i class="fas fa-layer-group"></i>
        <span>Flashcards</span>
      </a>
    </div>
  </div>
</nav>

<!-- Main Content -->
<div class="container mt-4">
  <!-- Header Card -->
  <div class="card mb-4">
    <div class="card-header">
      <h4><i class="fas fa-brain me-2"></i>Data Structures & Algorithms</h4>
      <p class="mb-0">Select a topic to learn and practice with 25 questions per test</p>
    </div>
    <div class="card-body">
      <div class="row mb-3">
        <div class="col-md-6">
          <input type="text" class="form-control" placeholder="Search topics..." 
                 [(ngModel)]="searchText" (input)="filterTopics()">
        </div>
        <div class="col-md-6">
          <select class="form-select" [(ngModel)]="selectedCategory" (change)="filterTopics()">
            <option *ngFor="let cat of categories" [value]="cat">
              {{ cat === 'all' ? 'All Categories' : cat }}
            </option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="text-center py-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-3">Loading topics...</p>
  </div>

  <!-- Topics Grid - UPDATED LAYOUT -->
  <div *ngIf="!isLoading && filteredTopics.length > 0" class="topics-grid">
    <div *ngFor="let topic of filteredTopics" class="topic-card">
      <div class="card-header">
        <h6>{{ topic.name }}</h6>
        <span class="badge bg-light">{{ topic.category }}</span>
      </div>
      <div class="card-body">
        <p class="card-text">{{ topic.description }}</p>
        
        <!-- Test Information -->
        <div class="test-info">
          <div class="test-stats">
            <div class="stat">
              <strong>Questions:</strong> 25
            </div>
            <div class="stat">
              <strong>Attempts:</strong> {{ topic.totalAttempts || 0 }}
            </div>
            <div *ngIf="topic.bestScore !== undefined && topic.bestScore > 0" class="stat best-score">
              <strong>Best Score:</strong> 
              <span [class]="getScoreColor(topic.bestScore!)">{{ topic.bestScore }}%</span>
            </div>
          </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container">
          <div class="progress">
            <div class="progress-bar" [style.width]="(topic.hints.length / 50) * 100 + '%'"></div>
          </div>
          <small class="progress-text">{{ topic.hints.length }}/50 hints available</small>
        </div>
      </div>
      <div class="card-footer">
        <div class="topic-actions">
          <button class="btn btn-outline-primary btn-sm" (click)="viewTopicDetails(topic)">
            <i class="fas fa-book me-1"></i>Learn
          </button>
          <button class="btn btn-primary btn-sm" (click)="takeTest(topic)">
            <i class="fas fa-play me-1"></i>Test
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading && filteredTopics.length === 0" class="text-center py-5">
    <i class="fas fa-search fa-3x text-muted mb-3"></i>
    <h4>No topics found</h4>
    <p class="text-muted">Try adjusting your search or filter criteria</p>
  </div>
</div>